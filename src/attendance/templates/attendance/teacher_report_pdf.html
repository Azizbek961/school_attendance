<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ filename }} - SAMO School</title>
    <style>
        /* Professional Print Styles */
        @page {
            size: A4;
            margin: 1.5cm;
        }

        @page :first {
            margin-top: 2cm;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', 'Helvetica Neue', Helvetica, sans-serif;
            line-height: 1.4;
            color: #2c3e50;
            background: #ffffff;
            padding: 20px;
            max-width: 100%;
            -webkit-print-color-adjust: exact !important;
            print-color-adjust: exact !important;
        }

        /* School Header */
        .school-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #4a6f8a;
            position: relative;
        }

        .school-logo {
            margin-bottom: 15px;
        }

        .logo-circle {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 15px;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.2);
        }

        .logo-circle i {
            font-size: 36px;
            color: white;
        }

        .school-name {
            font-size: 28px;
            font-weight: 800;
            color: #2c3e50;
            margin-bottom: 8px;
            letter-spacing: 1px;
        }

        .school-subtitle {
            font-size: 14px;
            color: #7f8c8d;
            margin-bottom: 15px;
            font-weight: 400;
        }

        .report-title {
            font-size: 22px;
            color: #3498db;
            margin: 15px 0;
            padding: 10px 0;
            border-top: 2px solid #ecf0f1;
            border-bottom: 2px solid #ecf0f1;
            font-weight: 600;
        }

        /* Report Metadata */
        .report-meta {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            border: 1px solid #e9ecef;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .meta-icon {
            width: 36px;
            height: 36px;
            background: #3498db;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            flex-shrink: 0;
        }

        .meta-content h4 {
            font-size: 12px;
            color: #7f8c8d;
            margin-bottom: 4px;
            font-weight: 500;
        }

        .meta-content p {
            font-size: 14px;
            color: #2c3e50;
            font-weight: 600;
            margin: 0;
        }

        /* Summary Section */
        .summary-section {
            margin-bottom: 30px;
        }

        .section-title {
            font-size: 18px;
            color: #2c3e50;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #3498db;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section-title i {
            color: #3498db;
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            border: 1px solid #e9ecef;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .stat-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .stat-title {
            font-size: 14px;
            color: #7f8c8d;
            font-weight: 500;
        }

        .stat-value {
            font-size: 32px;
            font-weight: 800;
            color: #2c3e50;
            line-height: 1;
        }

        .stat-change {
            font-size: 12px;
            padding: 4px 8px;
            border-radius: 20px;
            font-weight: 500;
        }

        .positive {
            background: #d4edda;
            color: #155724;
        }

        .negative {
            background: #f8d7da;
            color: #721c24;
        }

        /* Tables */
        .table-container {
            overflow-x: auto;
            margin-bottom: 30px;
            border-radius: 10px;
            border: 1px solid #e9ecef;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 12px;
            min-width: 600px;
        }

        .data-table thead {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .data-table th {
            padding: 12px 15px;
            text-align: left;
            font-weight: 600;
            border: none;
            font-size: 13px;
            white-space: nowrap;
        }

        .data-table tbody tr {
            border-bottom: 1px solid #e9ecef;
            transition: background-color 0.2s ease;
        }

        .data-table tbody tr:nth-child(even) {
            background-color: #f8f9fa;
        }

        .data-table tbody tr:hover {
            background-color: #e9ecef;
        }

        .data-table td {
            padding: 10px 15px;
            vertical-align: middle;
            border: none;
        }

        /* Badges */
        .status-badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 11px;
            font-weight: 600;
            display: inline-block;
            text-align: center;
            min-width: 70px;
        }

        .status-present {
            background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%);
            color: white;
        }

        .status-absent {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            color: white;
        }

        .status-late {
            background: linear-gradient(135deg, #f39c12 0%, #d35400 100%);
            color: white;
        }

        .status-excused {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
        }

        .percentage-badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 11px;
            font-weight: 600;
            display: inline-block;
            text-align: center;
            min-width: 60px;
        }

        .percentage-high {
            background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%);
            color: white;
        }

        .percentage-medium {
            background: linear-gradient(135deg, #f39c12 0%, #d35400 100%);
            color: white;
        }

        .percentage-low {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            color: white;
        }

        /* Charts for PDF */
        .chart-container {
            margin: 30px 0;
            padding: 20px;
            background: white;
            border: 1px solid #e9ecef;
            border-radius: 10px;
        }

        .chart-title {
            font-size: 16px;
            color: #2c3e50;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .chart-placeholder {
            height: 200px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #7f8c8d;
            font-size: 14px;
        }

        /* Footer */
        .report-footer {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 2px solid #ecf0f1;
            text-align: center;
        }

        .signature-area {
            margin: 30px auto;
            width: 300px;
            text-align: center;
        }

        .signature-line {
            width: 250px;
            border-bottom: 2px solid #2c3e50;
            margin: 20px auto 5px auto;
        }

        .footer-info {
            font-size: 11px;
            color: #7f8c8d;
            margin-top: 20px;
            line-height: 1.6;
        }

        /* Page Break Control */
        .page-break {
            page-break-before: always;
            margin-top: 50px;
        }

        .no-break {
            page-break-inside: avoid;
        }

        /* Print Optimization */
        @media print {
            body {
                padding: 0;
                margin: 0;
                font-size: 12px;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }

            .school-header {
                margin-top: 0;
                padding-top: 0;
            }

            .report-meta {
                background: #f8f9fa !important;
                -webkit-print-color-adjust: exact;
            }

            .data-table thead {
                background: #667eea !important;
                -webkit-print-color-adjust: exact;
                color: white !important;
            }

            .status-badge, .percentage-badge {
                -webkit-print-color-adjust: exact;
                color: white !important;
            }

            .stat-card {
                box-shadow: none;
                border: 1px solid #dee2e6;
            }

            .no-print {
                display: none !important;
            }

            a {
                text-decoration: none;
                color: inherit;
            }

            .page-break {
                page-break-before: always;
                margin-top: 2cm;
            }
        }

        /* Screen Specific Styles */
        @media screen {
            body {
                max-width: 1200px;
                margin: 0 auto;
                background: #f5f7fa;
                padding: 30px;
            }

            .print-container {
                background: white;
                padding: 40px;
                box-shadow: 0 10px 30px rgba(0,0,0,0.1);
                border-radius: 15px;
                margin-bottom: 30px;
            }

            .screen-controls {
                position: fixed;
                bottom: 20px;
                right: 20px;
                z-index: 1000;
                display: flex;
                gap: 10px;
            }

            .control-btn {
                width: 50px;
                height: 50px;
                border-radius: 50%;
                background: #3498db;
                color: white;
                border: none;
                cursor: pointer;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 18px;
                box-shadow: 0 4px 12px rgba(52, 152, 219, 0.3);
                transition: all 0.3s ease;
            }

            .control-btn:hover {
                transform: translateY(-2px);
                box-shadow: 0 6px 16px rgba(52, 152, 219, 0.4);
            }

            .control-btn.print {
                background: #2ecc71;
            }

            .control-btn.download {
                background: #9b59b6;
            }

            .control-btn.close {
                background: #e74c3c;
            }
        }

        /* Mobile Responsive */
        @media screen and (max-width: 768px) {
            body {
                padding: 15px;
            }

            .print-container {
                padding: 20px;
            }

            .school-name {
                font-size: 22px;
            }

            .report-title {
                font-size: 18px;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .report-meta {
                grid-template-columns: 1fr;
            }

            .data-table {
                font-size: 11px;
            }

            .data-table th,
            .data-table td {
                padding: 8px 10px;
            }

            .screen-controls {
                bottom: 10px;
                right: 10px;
            }

            .control-btn {
                width: 44px;
                height: 44px;
                font-size: 16px;
            }
        }

        /* Animation */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .print-container {
            animation: fadeIn 0.5s ease-out;
        }
    </style>
</head>
<body>
    <div class="print-container">
        <!-- School Header -->
        <div class="school-header">
            <div class="school-logo">
                <div class="logo-circle">
                    <i class="fas fa-school"></i>
                </div>
            </div>

            <h1 class="school-name">SAMO International School</h1>
            <p class="school-subtitle">Xalqaro Ta'lim va Taraqqiyot Maktabi</p>

            <h2 class="report-title">
                {% if report_type == 'summary' %}
                    üìä Umumiy Davomat Hisoboti
                {% elif report_type == 'detailed' %}
                    üìù Batafsil Davomat Hisoboti
                {% elif report_type == 'student' %}
                    üë®‚Äçüéì O'quvchi Statistikasi
                {% elif report_type == 'subject' %}
                    üìö Fanlar Bo'yicha Hisobot
                {% elif report_type == 'daily' %}
                    üìÖ Kunlik Hisobot
                {% else %}
                    üìÑ Davomat Hisoboti
                {% endif %}
            </h2>
        </div>

        <!-- Report Metadata -->
        <div class="report-meta">
            <div class="meta-item">
                <div class="meta-icon">
                    <i class="fas fa-user-tie"></i>
                </div>
                <div class="meta-content">
                    <h4>O'qituvchi</h4>
                    <p>{{ teacher.get_full_name }}</p>
                </div>
            </div>

            <div class="meta-item">
                <div class="meta-icon">
                    <i class="fas fa-calendar-alt"></i>
                </div>
                <div class="meta-content">
                    <h4>Yaratilgan sana</h4>
                    <p>{{ generated_at }}</p>
                </div>
            </div>

            {% if report_data.metadata %}
            <div class="meta-item">
                <div class="meta-icon">
                    <i class="fas fa-clock"></i>
                </div>
                <div class="meta-content">
                    <h4>Davr</h4>
                    <p>{{ report_data.metadata.start_date }} - {{ report_data.metadata.end_date }}</p>
                </div>
            </div>

            <div class="meta-item">
                <div class="meta-icon">
                    <i class="fas fa-database"></i>
                </div>
                <div class="meta-content">
                    <h4>Jami yozuvlar</h4>
                    <p>{{ report_data.metadata.total_records }} ta</p>
                </div>
            </div>
            {% endif %}
        </div>

        <!-- Report Type Summary -->
        <div class="summary-section">
            <h3 class="section-title">
                <i class="fas fa-info-circle"></i>
                Hisobot ma'lumotlari
            </h3>

            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-header">
                        <span class="stat-title">Hisobot turi</span>
                        <span class="stat-change positive">
                            {% if report_type == 'summary' %}
                                Umumiy
                            {% elif report_type == 'detailed' %}
                                Batafsil
                            {% elif report_type == 'student' %}
                                O'quvchi
                            {% elif report_type == 'subject' %}
                                Fan
                            {% elif report_type == 'daily' %}
                                Kunlik
                            {% endif %}
                        </span>
                    </div>
                    <div class="stat-value">
                        {% if report_type == 'summary' %}
                            üìä
                        {% elif report_type == 'detailed' %}
                            üìù
                        {% elif report_type == 'student' %}
                            üë®‚Äçüéì
                        {% elif report_type == 'subject' %}
                            üìö
                        {% elif report_type == 'daily' %}
                            üìÖ
                        {% endif %}
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-header">
                        <span class="stat-title">Davomiyligi</span>
                        <span class="stat-change positive">Faol</span>
                    </div>
                    <div class="stat-value">
                        {% if report_data.metadata %}
                            {{ report_data.metadata.total_records }}
                        {% else %}
                            0
                        {% endif %}
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-header">
                        <span class="stat-title">Holati</span>
                        <span class="stat-change positive">Tayyor</span>
                    </div>
                    <div class="stat-value">‚úÖ</div>
                </div>

                <div class="stat-card">
                    <div class="stat-header">
                        <span class="stat-title">Versiya</span>
                        <span class="stat-change">1.0</span>
                    </div>
                    <div class="stat-value">üìÑ</div>
                </div>
            </div>
        </div>

        <!-- Main Report Content -->
        {% if report_type == 'summary' %}
        <div class="summary-section no-break">
            <h3 class="section-title">
                <i class="fas fa-chart-bar"></i>
                Umumiy statistikasi
            </h3>

            <div class="table-container">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Davr</th>
                            <th>Jami</th>
                            <th>Qatnashgan</th>
                            <th>Qatnashmagan</th>
                            <th>Kech qolgan</th>
                            <th>Foiz</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for item in report_data.summary %}
                        <tr>
                            <td><strong>{{ item.period }}</strong></td>
                            <td>{{ item.total }}</td>
                            <td>{{ item.present }}</td>
                            <td>{{ item.absent }}</td>
                            <td>{{ item.late|default:"0" }}</td>
                            <td>
                                <span class="percentage-badge
                                    {% if item.percentage >= 90 %}percentage-high
                                    {% elif item.percentage >= 70 %}percentage-medium
                                    {% else %}percentage-low{% endif %}">
                                    {{ item.percentage }}%
                                </span>
                            </td>
                        </tr>
                        {% endfor %}

                        {% if report_data.totals %}
                        <tr style="background: #f8f9fa; font-weight: bold;">
                            <td>Jami:</td>
                            <td>{{ report_data.totals.total }}</td>
                            <td>{{ report_data.totals.present }}</td>
                            <td>{{ report_data.totals.absent }}</td>
                            <td>{{ report_data.totals.late|default:"0" }}</td>
                            <td></td>
                        </tr>
                        {% endif %}
                    </tbody>
                </table>
            </div>
        </div>

        {% elif report_type == 'detailed' %}
        <div class="summary-section no-break">
            <h3 class="section-title">
                <i class="fas fa-list-alt"></i>
                Batafsil davomat yozuvlari
            </h3>

            <div class="table-container">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Sana</th>
                            <th>O'quvchi</th>
                            <th>Sinf</th>
                            <th>Fan</th>
                            <th>Holat</th>
                            <th>Vaqt</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for item in report_data.detailed %}
                        <tr>
                            <td>{{ item.date }}</td>
                            <td><strong>{{ item.student_name }}</strong></td>
                            <td>{{ item.class_name }}</td>
                            <td>{{ item.subject_name }}</td>
                            <td>
                                <span class="status-badge
                                    {% if item.status_code == 'present' %}status-present
                                    {% elif item.status_code == 'absent' %}status-absent
                                    {% elif item.status_code == 'late' %}status-late
                                    {% else %}status-excused{% endif %}">
                                    {{ item.status }}
                                </span>
                            </td>
                            <td>{{ item.time|default:"-" }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>

            <div style="text-align: right; margin-top: 10px; font-size: 12px; color: #7f8c8d;">
                Jami: {{ report_data.count }} ta yozuv
            </div>
        </div>

        {% elif report_type == 'student' %}
        <div class="summary-section no-break">
            <h3 class="section-title">
                <i class="fas fa-users"></i>
                O'quvchilar davomat statistikasi
            </h3>

            <div class="table-container">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>O'quvchi</th>
                            <th>Sinf</th>
                            <th>Qatnashgan</th>
                            <th>Qatnashmagan</th>
                            <th>Kech qolgan</th>
                            <th>Foiz</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for item in report_data.students %}
                        <tr>
                            <td>{{ forloop.counter }}</td>
                            <td><strong>{{ item.student_name }}</strong></td>
                            <td>{{ item.class_name }}</td>
                            <td>{{ item.present }}</td>
                            <td>{{ item.absent }}</td>
                            <td>{{ item.late }}</td>
                            <td>
                                <span class="percentage-badge
                                    {% if item.percentage >= 90 %}percentage-high
                                    {% elif item.percentage >= 70 %}percentage-medium
                                    {% else %}percentage-low{% endif %}">
                                    {{ item.percentage }}%
                                </span>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 20px;">
                <div style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
                    <h4 style="font-size: 14px; color: #7f8c8d; margin-bottom: 8px;">O'rtacha foiz</h4>
                    <p style="font-size: 24px; font-weight: bold; color: #3498db;">{{ report_data.average_percentage }}%</p>
                </div>
                <div style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
                    <h4 style="font-size: 14px; color: #7f8c8d; margin-bottom: 8px;">Jami o'quvchilar</h4>
                    <p style="font-size: 24px; font-weight: bold; color: #2ecc71;">{{ report_data.total_students }} ta</p>
                </div>
            </div>
        </div>

        {% elif report_type == 'subject' %}
        <div class="summary-section no-break">
            <h3 class="section-title">
                <i class="fas fa-book-open"></i>
                Fanlar bo'yicha statistikasi
            </h3>

            <div class="table-container">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Fan</th>
                            <th>Qatnashgan</th>
                            <th>Jami</th>
                            <th>Foiz</th>
                            <th>Sinflar</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for item in report_data.subjects %}
                        <tr>
                            <td>{{ forloop.counter }}</td>
                            <td><strong>{{ item.subject_name }}</strong></td>
                            <td>{{ item.present }}</td>
                            <td>{{ item.total }}</td>
                            <td>
                                <span class="percentage-badge
                                    {% if item.percentage >= 90 %}percentage-high
                                    {% elif item.percentage >= 70 %}percentage-medium
                                    {% else %}percentage-low{% endif %}">
                                    {{ item.percentage }}%
                                </span>
                            </td>
                            <td>{{ item.classes_count }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 20px;">
                <div style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
                    <h4 style="font-size: 14px; color: #7f8c8d; margin-bottom: 8px;">O'rtacha foiz</h4>
                    <p style="font-size: 24px; font-weight: bold; color: #3498db;">{{ report_data.average_percentage }}%</p>
                </div>
                <div style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
                    <h4 style="font-size: 14px; color: #7f8c8d; margin-bottom: 8px;">Jami fanlar</h4>
                    <p style="font-size: 24px; font-weight: bold; color: #2ecc71;">{{ report_data.total_subjects }} ta</p>
                </div>
            </div>
        </div>

        {% elif report_type == 'daily' %}
        <div class="summary-section no-break">
            <h3 class="section-title">
                <i class="fas fa-calendar-day"></i>
                Kunlik davomat statistikasi
            </h3>

            <div class="table-container">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Sana</th>
                            <th>Hafta kuni</th>
                            <th>Jami</th>
                            <th>Qatnashgan</th>
                            <th>Foiz</th>
                            <th>Holat</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for item in report_data.daily %}
                        <tr>
                            <td>{{ item.date }}</td>
                            <td>{{ item.day }}</td>
                            <td>{{ item.total }}</td>
                            <td>{{ item.present }}</td>
                            <td>
                                <span class="percentage-badge
                                    {% if item.percentage >= 90 %}percentage-high
                                    {% elif item.percentage >= 70 %}percentage-medium
                                    {% else %}percentage-low{% endif %}">
                                    {{ item.percentage }}%
                                </span>
                            </td>
                            <td>
                                {% if item.percentage >= 90 %}
                                    <span style="color: #27ae60;">‚úÖ Juda yaxshi</span>
                                {% elif item.percentage >= 70 %}
                                    <span style="color: #f39c12;">‚ö†Ô∏è O'rtacha</span>
                                {% else %}
                                    <span style="color: #e74c3c;">‚ùå Yomon</span>
                                {% endif %}
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 20px;">
                <div style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
                    <h4 style="font-size: 14px; color: #7f8c8d; margin-bottom: 8px;">O'rtacha kunlik foiz</h4>
                    <p style="font-size: 24px; font-weight: bold; color: #3498db;">{{ report_data.average_daily }}%</p>
                </div>
                <div style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
                    <h4 style="font-size: 14px; color: #7f8c8d; margin-bottom: 8px;">Jami kunlar</h4>
                    <p style="font-size: 24px; font-weight: bold; color: #2ecc71;">{{ report_data.days_count }} kun</p>
                </div>
            </div>
        </div>
        {% endif %}

        <!-- Charts Placeholder -->
        <div class="chart-container no-break">
            <h3 class="chart-title">üìà Davomat grafikasi</h3>
            <div class="chart-placeholder">
                <div style="text-align: center;">
                    <i class="fas fa-chart-bar" style="font-size: 36px; color: #3498db; margin-bottom: 10px;"></i>
                    <p>Grafik ma'lumotlari bu hisobotga avtomatik joylashtiriladi</p>
                </div>
            </div>
        </div>

        <!-- Signature Area -->
        <div class="report-footer">
            <div class="signature-area">
                <div class="signature-line"></div>
                <p style="margin-top: 10px; font-size: 14px;">
                    {{ teacher.get_full_name }}<br>
                    <span style="color: #7f8c8d; font-size: 12px;">O'qituvchi</span>
                </p>
            </div>

            <div class="footer-info">
                <p><strong>SAMO International School</strong> | Davomat Monitoring Tizimi</p>
                <p>Hisobot yaratilgan sana: {{ generated_at }} | Fayl nomi: {{ filename }}</p>
                <p style="font-size: 10px; margin-top: 10px; color: #95a5a6;">
                    Bu hisobot faqat ichki maqsadlarda foydalanish uchun mo'ljallangan.<br>
                    Har qanday nusxa ko'chirish va tarqatish qonuniy javobgarlikni talab qiladi.
                </p>
            </div>
        </div>
    </div>

    <!-- Screen Controls (Only visible on screen) -->
    <div class="screen-controls no-print">
        <button class="control-btn print" onclick="window.print()" title="Chop etish">
            <i class="fas fa-print"></i>
        </button>
        <button class="control-btn download" onclick="downloadPDF()" title="PDF yuklab olish">
            <i class="fas fa-download"></i>
        </button>
        <button class="control-btn close" onclick="window.close()" title="Yopish">
            <i class="fas fa-times"></i>
        </button>
    </div>

    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

    <script>
        // Auto-print if specified in URL
        if (window.location.search.includes('print=true')) {
            setTimeout(() => {
                window.print();
            }, 1000);
        }

        // PDF Download Function
        function downloadPDF() {
            // Create a print-friendly version
            const printWindow = window.open('', '_blank');
            const title = document.title;
            const content = document.querySelector('.print-container').innerHTML;
            const styles = document.querySelector('style').innerHTML;

            printWindow.document.write(`
                <!DOCTYPE html>
                <html lang="uz">
                <head>
                    <meta charset="UTF-8">
                    <meta name="viewport" content="width=device-width, initial-scale=1.0">
                    <title>${title}</title>
                    <style>
                        ${styles}
                        .screen-controls { display: none !important; }
                        .no-print { display: none !important; }
                        body { padding: 0; margin: 0; }
                        @page { size: A4; margin: 1.5cm; }
                    </style>
                    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
                </head>
                <body>
                    ${content}
                    <script>
                        setTimeout(() => window.print(), 500);
                    <\/script>
                </body>
                </html>
            `);

            printWindow.document.close();
        }

        // Add page numbers for print
        if (window.matchMedia && window.matchMedia('print').matches) {
            // Print-specific code
            document.addEventListener('DOMContentLoaded', function() {
                const totalPages = Math.ceil(document.body.scrollHeight / 1123); // A4 height in pixels at 96dpi
                const footer = document.querySelector('.report-footer');

                if (footer) {
                    footer.innerHTML += `
                        <div style="position: fixed; bottom: 20px; right: 20px; font-size: 10px; color: #95a5a6;">
                            Sahifa: <span class="pageNumber"></span> / <span class="totalPages"></span>
                        </div>
                    `;
                }
            });
        }

        // Handle responsive adjustments
        function adjustForScreen() {
            const isPrint = window.matchMedia('print').matches;

            if (!isPrint) {
                // Add animations for screen view
                document.querySelectorAll('.stat-card, .table-container').forEach(el => {
                    el.style.animation = 'fadeIn 0.5s ease-out';
                });
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', adjustForScreen);
        window.matchMedia('print').addListener(adjustForScreen);
    </script>
</body>
</html>